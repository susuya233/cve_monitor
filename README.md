# CVE漏洞监控推送系统

## 项目简介

该项目用于监控多个安全平台的最新CVE漏洞信息，并通过多种渠道（钉钉、飞书、Telegram等）进行实时推送。

系统融合了以下多个数据源的漏洞信息：
- OSCS1024漏洞库
- 安天威胁情报
- Tenable平台
- 微软安全中心
- CVE平台

## 功能特性

- **多平台监控**：同时监控多个漏洞平台的最新CVE信息
- **多渠道推送**：支持钉钉、飞书、Server酱、PushPlus、Telegram Bot等多种推送渠道
- **去重处理**：使用SQLite数据库存储已推送的漏洞信息，避免重复推送
- **健壮性优化**：增强了异常处理、资源管理、中断处理等功能
- **灵活配置**：通过YAML配置文件可以灵活定制推送渠道和系统参数

## 安装依赖

```bash
pip install -r requirements.txt
```

## 配置说明

在`config.yaml`文件中配置推送渠道和相关参数：

```yaml
# 推送平台配置
push_channels:
  # 钉钉推送配置
  dingding:
    enable: 1  # 1启用, 0禁用
    webhook: "钉钉机器人webhook地址"
    secretKey: "钉钉机器人密钥"
    app_name: "钉钉"
  
  # 飞书推送配置
  feishu:
    enable: 0  # 1启用, 0禁用
    webhook: "飞书机器人webhook地址"
    app_name: "飞书"
  
  # 更多配置...

# 系统配置
system:
  # 抓取频率 (秒)
  fetch_interval: 300
  # 日志保留天数
  log_retention: 30
  # 是否启用调试模式
  debug: 0
```

## 使用方法

直接运行主程序即可：

```bash
python CVE_monitor.py
```

程序会自动创建所需的目录和数据库，并开始监控和推送最新的CVE信息。

## 优化内容

1. **健壮性增强**：
   - 增加异常处理和日志记录
   - 添加中断信号处理
   - 实现健康检查和自动恢复机制
   - 添加HTTP请求重试机制

2. **性能优化**：
   - 优化数据库操作
   - 减少不必要的HTTP请求
   - 使用会话（Session）复用连接

3. **代码结构优化**：
   - 更清晰的配置文件结构
   - 更合理的异常处理流程
   - 优化日志记录格式

4. **功能增强**：
   - 添加启动和停止通知
   - 支持多线程运行（主线程和健康检查线程）
   - 分段休眠以响应中断信号
   - 更灵活的配置选项

## 日志说明

系统日志存放在`log`目录下：
- `run.log`：运行日志，记录程序运行状态
- `err.log`：错误日志，记录程序异常信息

日志文件会按天进行切割，并保留最近30天的日志记录。

## 注意事项

1. 确保配置文件中至少启用了一个推送渠道
2. 程序设计为长时间运行，支持优雅退出（Ctrl+C）
3. 如需修改抓取频率，请在配置文件的system部分调整fetch_interval参数 
